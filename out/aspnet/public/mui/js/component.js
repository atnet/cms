/* 警告:此文件由系统自动生成,请勿修改,因为可能导致您的更改丢失! */
if (!window._path) {window._path = 'admin';}window.sites = [];window.groupname = null;if (window.menuData == undefined) {jr.xhr.get(window._path + '?module=ajax&action=appinit', function (x) {var ip, address, md, username;eval(x);window.menuData = md;jr.json.bind(document, { userName: username });});}if (window.menuHandler == undefined) {window.menuHandler = null;}function showGate() {var els = document.getElementsByTagName("DIV");els[0].className = 'loading-gate';els[1].className = 'loading-bar';if (/MSIE\s*(5|6|7)\./.test(window.navigator.userAgent)) {els[1].style.left = (document.documentElement.clientWidth - els[1].offsetWidth) / 2 + 'px';els[1].style.top = (document.documentElement.clientHeight - els[1].offsetHeight) / 2 + 'px';}}function cancelGate() {var els = document.getElementsByTagName("DIV");els[0].className = 'loading-gate hidden';els[1].className = 'loading-bar hidden';}var FwMenu = {ele: null,menuTitles: [],getByCls: function (className) {return this.ele.getElementsByClassName ? this.ele.getElementsByClassName(className) : document.getElementsByClassName(className, this.ele);},init: function (data, menuHandler) {this.ele = document.getElementsByClassName('page-left-menu')[0];var md = data;if (menuHandler && menuHandler instanceof Function) {var hdata = menuHandler(data);if (hdata != undefined && hdata != null) {md = hdata;}}var menuEle = this.ele;menuEle.innerHTML = '';var html, linkText, url;for (var i1 = 0; i1 < md.length; i1++) {html = '';for (var i2 = 0; i2 < md[i1].childs.length; i2++) {if (md[i1].childs[i2].childs.length > 0) {html += '<div class="group hidden"><div class="group-title" group="' + md[i1].id + '" style="cursor:pointer" title="点击展开操作菜单"><span>' + md[i1].childs[i2].text + '</span></div>';html += '<div class="panel hidden"><ul id="fns_' + i2 + '">';for (var i3 = 0; i3 < md[i1].childs[i2].childs.length; i3++) {linkText = md[i1].childs[i2].childs[i3].text;url = md[i1].childs[i2].childs[i3].uri;html += '<li' + (i2 == 0 && i3 == 0 ? ' class="current"' : '') + '><a class="fn" style="cursor:pointer;" url="' + url + '"' + '><span class="icon icon_' + i1 + '_' + i2 + '_' + i3 + '"></span>' + linkText + '</a></li>';}html += '</ul></div></div>';}}menuEle.innerHTML += html;}this.menuTitles = this.getByCls('group-title');var t = this;jr.each(this.menuTitles, function (i, e) {var groupName = e.getAttribute('group');jr.event.add(e, 'click', (function (_t, _e) {return function () {_t.show(_e);};})(t, e));jr.each(e.nextSibling.getElementsByTagName('LI'), function (i2, e2) {jr.event.add(e2, 'click', (function (_this, _t, g) {return function () {_t.set(groupName, _this);var a = _this.childNodes[0];if (a.url != '') {FwTab.show(a.innerHTML, a.getAttribute('url'));}};})(e2, t, groupName));});});},change: function (id) {var menuTitles = this.menuTitles;var groupName = id;if (!groupName) {if (menuTitles.length == 0) {return;} else {groupName = menuTitles[0].getAttribute('group');}}var isFirst = true;var selectedLi = null;var firstPanel = null;var titleGroups = [];var _lis;jr.each(menuTitles, function (i, e) {if (e.getAttribute('group') != groupName) {e.parentNode.className = 'group hidden';} else {titleGroups.push(e);e.parentNode.className = 'group';if (firstPanel == null) {firstPanel = e.nextSibling;}}});for (var i = 0; i < titleGroups.length; i++) {_lis = titleGroups[i].nextSibling.getElementsByTagName('LI');for (var j = 0; j < _lis.length; j++) {if (_lis[j].className == 'current') {selectedLi = _lis[j];i = titleGroups.length + 1;break;}}}if (selectedLi != null) {selectedLi.parentNode.parentNode.className = 'panel';} else if (firstPanel != null) {firstPanel.className = 'panel';}},show: function (titleDiv) {var groupName = titleDiv.getAttribute('group');jr.each(this.menuTitles, function (i, e) {if (e.getAttribute('group') == groupName) {if (e != titleDiv) {e.nextSibling.className = 'panel hidden';} else {e.nextSibling.className = 'panel';}}});},set: function (groupName, ele) {jr.each(this.menuTitles, function (i, e) {if (e.getAttribute('group') == groupName) {jr.each(e.nextSibling.getElementsByTagName('LI'), function (i, e2) {e2.className = ele == e2 ? 'current' : '';});}});}};var FwTab = {frames: null,tabs: null,initialize: function () {var framebox = jr.$('pageframes');this.tabs = jr.$('pagetabs').getElementsByTagName('UL')[0];var getByCls = function (cls) {return (framebox.getElementsByClassName ? framebox.getElementsByClassName(cls) : document.getElementsByClassName(cls, framebox))[0];};this.frames = getByCls('frames');},pageBeforeLoad: function () {this.showLoadBar();},pageLoad: function () {this.hiddenLoadBar();},showLoadBar: function () { },hiddenLoadBar: function () { },show: function (text, url, closeable) {var _tabs = this.tabs.getElementsByTagName('LI');var _indent;var _exits = false;var _cur_indents = url;var _li = null;jr.each(_tabs, function (i, obj) {_indent = obj.getAttribute('indent');if (_indent == _cur_indents) {_exits = true;obj.className = 'current';_li = obj;}});if (!_exits) {this.pageBeforeLoad();var frameDiv = document.createElement('DIV');var frame;try {frame = document.createElement('<IFRAME frameborder="0">');} catch (ex) {frame = document.createElement('IFRAME');}frame.src = url;frameDiv.appendChild(frame);this.frames.appendChild(frameDiv);var _loadCall = (function (t) {return function () {t.pageLoad.apply(t);};})(this);frame.frameBorder = '0';frame.setAttribute('frameBorder', '0', 0);frame.setAttribute('indent', _cur_indents);frame.setAttribute('id', 'ifr_' + _cur_indents);jr.event.add(frame, 'load', _loadCall);_li = document.createElement('LI');_li.onmouseout = (function (t) {return function () {if (t.className != 'current') t.className = '';};})(_li);_li.onmouseover = (function (t) {return function () {if (t.className != 'current') t.className = 'hover';};})(_li);_li.setAttribute('indent', _cur_indents);_li.innerHTML = '<span class="txt"><span class="tab-title" onclick="FwTab.set(this)">' + text + '</span>'+ (closeable == false ? '' : '<span class="tab-close" title="关闭选项卡" onclick="FwTab.close(this);">x</span>')+ '</span><span class="rgt"></span>';this.tabs.appendChild(_li);}this.set(_li, true);},set: function (t, isOpen) {if (!isOpen) {this.hiddenLoadBar();}var li = t.nodeName != 'LI' ? t.parentNode.parentNode : t;var _frames = this.frames.getElementsByTagName('DIV');var _lis = this.tabs.getElementsByTagName('LI');jr.each(_lis, function (i, obj) {if (obj == li) {obj.className = 'current';_frames[i].className = 'current';_frames[i].style.height = '100%';} else {obj.className = '';_frames[i].className = '';_frames[i].style.height = '0px';}});},close: function (t) {var closeIndex = -1;var isActived = false;var closeLi = null;if (t) {if (t.nodeName == 'SPAN') {var list = jr.dom.getsByClass(this.tabs, 'tab-close');var noCloseBtnLen = this.tabs.getElementsByTagName('LI').length - list.length;for (var i = 0; i < list.length; i++) {if (list[i] == t) {closeIndex = i + noCloseBtnLen;closeLi = list[i].parentNode.parentNode;break;}}}else if (typeof (t) == 'string') {var list = jr.dom.getsByClass(this.tabs, 'tab-title');for (var i = 0; i < list.length; i++) {if (t == list[i].innerHTML.replace(/<[^>]+>/g, '')) {closeIndex = i;closeLi = list[i].parentNode.parentNode;break;}}}} else {var _lis = this.tabs.getElementsByTagName('LI');for (var i = 0; i < _lis.length; i++) {if (_lis[i].className == 'current') {closeIndex = i;closeLi = _lis[i];break;}}}if (closeLi) {isActived = closeLi.className == 'current';}if (closeIndex > 0) {var _lis = this.tabs.getElementsByTagName('LI');var _ifrs = this.frames.getElementsByTagName('DIV');var ifr = _ifrs[closeIndex].childNodes[0];if (ifr.nodeName == 'IFRAME') {ifr.src = '';ifr = null;}this.tabs.removeChild(_lis[closeIndex]);this.frames.removeChild(_ifrs[closeIndex]);if (isActived) {this.hiddenLoadBar();if (closeIndex >= _lis.length) {closeIndex = _lis.length - 1;}_lis[closeIndex].className = 'current';if (_ifrs[closeIndex]) {_ifrs[closeIndex].className = 'current';_ifrs[closeIndex].style.height = '100%';}}}},getWindow: function (t) {if (typeof (t) == 'string') {var frameIndex = -1;var list = jr.dom.getsByClass(this.tabs, 'tab-title');for (var i = 0; i < list.length; i++) {if (t == list[i].innerHTML.replace(/<[^>]+>/g, '')) {frameIndex = i;break;}}if (frameIndex == -1) return null;var frameDivs = this.frames.getElementsByTagName('DIV');if (frameIndex >= frameDivs.length) return null;var iframes = frameDivs[frameIndex].getElementsByTagName('IFRAME');if (iframes.length == 0) return null;return iframes[0].contentWindow;}return null;}};function loadApps() {var ele;jr.each(document.getElementsByTagName('H2'), function (i, e) {if (e.innerHTML == 'APPS') {ele = e.parentNode.getElementsByTagName('DIV')[0];}});if (ele) {ele.id = 'ribbon-apps';jr.load(ele, window._path + '?module=plugin&action=miniapps&ajax=1');}}window.M = {dialog: function (id, title, url, isAjax, width, height, closeCall) {newDialog(id, title, url, isAjax, width, height, closeCall);},alert: function (html, func) {jr.tipbox.show(html, false, 100, 2000, 'up');if (func) {setTimeout(func, 1000);}},msgtip: function (arg, func) {jr.tipbox.show(arg.html, false, 100, arg.autoClose ? 2000 : -1, 'up');if (func) {setTimeout(func, 1000);}},tip: function (msg, func) {this.msgtip({ html: msg, autoClose: true }, func);},loadCatTree: function () {_loadCategoryTree();},clearCache: function (t) {window.M.msgtip({ html: '清除中....' });jr.xhr.post(window._path, 'module=ajax&action=clearcache', function (x) {window.M.msgtip({ html: '缓存清除完成!', autoClose: true });jr.xhr.get('/');}, function (x) { });},addFavorite: function () {var url = location.href;var title = document.title;try {window.external.addFavorite(url, title);}catch (e) {try {window.sidebar.addPanel(title, url, "");}catch (e) {alert("浏览器不支持,请手动添加！");}}},setFullScreen: function (event) {if (!$(e_SD).parentNode.style || $(e_SD).parentNode.style.display != 'none') {$(e_HD).style.height = '0px';$(e_SD).style.width = '0px';$(e_FT).style.height = '0px';$(e_HD).style.overflow = 'hidden';$(e_SD).parentNode.style.cssText += 'display:none';} else {$(e_HD).style.overflow = '';$(e_HD).style.height = (window.M.epix.topHeight - 5) + 'px';$(e_SD).style.width = (window.M.epix.leftWidth - 1) + 'px';$(e_FT).style.height = (window.M.epix.footHeight - 1) + 'px';$(e_SD).parentNode.style.display = '';}window.onresize();}};var mainDiv = document.getElementsByClassName('page-main')[0];function getDivByCls(cls, ele) {var e = ele || mainDiv;return (e.getElementsByClassName ?e.getElementsByClassName(cls) :document.getElementsByClassName(cls, e))[0];}var leftDiv = getDivByCls('page-main-left');var rightDiv = getDivByCls('page-main-right');var frameDiv = getDivByCls('page-frames');var splitDiv = getDivByCls('page-main-split');var frameShadowDiv = getDivByCls('page-frame-shadow');var userDiv = getDivByCls('page-user', document.body);function _resizeWin() {var height = document.documentElement.clientHeight;var width = jr.screen.width();mainDiv.style.height = (height - mainDiv.offsetTop) + 'px';frameDiv.style.height = (mainDiv.offsetHeight - frameDiv.offsetTop) + 'px';rightDiv.style.width = (width - leftDiv.offsetWidth - splitDiv.offsetWidth + 1) + 'px';}jr.event.add(window, 'resize', _resizeWin);window.onload = function () {document.onkeydown = function (event) {var e = window.event || event;if (e.altKey && e.keyCode == 122) {window.M.setFullScreen();e.returnvalue = false;return false;} else if (e.ctrlKey && e.keyCode === 83) {return jr.event.preventDefault(event);} else if (e.keyCode === 122) {window.M.setFullScreen();e.returnvalue = false;return false;} else if (!e.ctrlKey && e.keyCode == 116) {var ifr = null;var ifrs = document.getElementsByTagName('IFRAME');for (var i = 0; i < ifrs.length; i++) {if (ifrs[i].className == 'current') {ifr = ifrs[i];break;}}if (ifr != null) {var src = ifr.src;ifr.src = '';ifr.src = src;}e.returnvalue = false;return false;}};_resizeWin();FwTab.initialize();new dragObject(splitDiv, window).custom(null, 'w-resize', (function (ld, rd, sd, minWidth, maxWidth) {return function (event) {frameShadowDiv.className = frameShadowDiv.className.replace(' hidden', '');var e = event || window.event;window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();if (e.preventDefault) e.preventDefault();var mx = e.clientX;if (mx > minWidth && mx < maxWidth) {sd.style.left = mx + 'px';ld.style.width = mx + 'px';ld.style.marginRight = -mx + 'px';rd.style.marginLeft = (mx + 5) + 'px';_resizeWin();}};})(leftDiv,rightDiv,splitDiv,splitDiv.getAttribute('min'),splitDiv.getAttribute('max')),function () {frameShadowDiv.className += ' hidden';});};function _loadCategoryTree() {var treeTitle = '站点栏目';var treeGroupName = 'content';var menuTitles = FwMenu.menuTitles;var e = null;for (var i = 0; i < menuTitles.length; i++) {e = menuTitles[i];var groupName = e.getAttribute('group');if (groupName == treeGroupName) {if (e.innerHTML.replace(/<[^>]+>/g, '') == treeTitle) {jr.load(e.nextSibling, window._path + '?module=category&action=tree&for=archives&siteid=&ajax=1&rd=' + Math.random() + '#noload', function (result) { });break;}}}}